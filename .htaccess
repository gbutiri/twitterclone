SetEnv PHP_VER 5

RewriteEngine on
RewriteBase /
Options +FollowSymLinks

AddDefaultCharset UTF-8

ErrorDocument 404 /404page.php

RewriteRule ^$ index.php

RewriteRule ^([^/\.]+)?/([a-zA-Z0-9]+)/([a-zA-Z0-9]+)$ profile.php?un=$1&page=$2&id=$3 [L,QSA]
RewriteRule ^([^/\.]+)?/([a-zA-Z0-9]+)$ profile.php?un=$1&page=$2 [L,QSA]
RewriteRule ^([^/\.]+)?/$ profile.php?un=$1 [L,QSA]
RewriteRule ^([^/\.]+)?$ profile.php?un=$1 [L,QSA]

# make all HTML requests go to PHP files
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)\.htm$ $1.php [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)\.html$ $1.php [NC]




# COMPRESSION / GZIP
# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
# remove browser bugs
BrowserMatch ^Mozilla/4 gzip-only-text/html
BrowserMatch ^Mozilla/4\.0[678] no-gzip
BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
Header append Vary User-Agent

# ETags
FileETag MTime Size
ExpiresActive On
Header unset Pragma
FileETag None
Header unset ETag

# Expire Headers

<ifModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 2592000 seconds"
  ExpiresByType text/html "access plus 2592000 seconds"
  ExpiresByType image/gif "access plus 2592000 seconds"
  ExpiresByType image/jpeg "access plus 2592000 seconds"
  ExpiresByType image/png "access plus 2592000 seconds"
  ExpiresByType text/css "access plus 604800 seconds"
  ExpiresByType application/x-javascript A2592000
  ExpiresByType application/javascript A2592000
  ExpiresByType text/javascript A2592000
</ifModule>

# file caching
<ifModule mod_headers.c>
	<FilesMatch "\\.(js|css|jpg|png|jpeg|gif)$">
		RequestHeader unset Cookie
		Header unset Set-Cookie
		Header set Cache-Control "max-age=864259200000"
	</FilesMatch>
  <filesMatch "\\.(css)$">
    Header set Cache-Control "max-age=604800, public"
  </filesMatch>
  <filesMatch "\\.(js)$">
    Header set Cache-Control "max-age=604800, private"
  </filesMatch>
  <filesMatch "\\.(xml|txt)$">
    Header set Cache-Control "max-age=216000, public, must-revalidate"
  </filesMatch>
  <filesMatch "\\.(html|htm|php)$">
    Header set Cache-Control "max-age=1, private, must-revalidate"
  </filesMatch>
</ifModule>

